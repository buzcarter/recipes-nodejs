{"version":3,"file":"recipeIndex.bundle.js","mappings":"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","sources":["webpack://recipes-nodejs/./src/static/scripts/libs/preferences.js","webpack://recipes-nodejs/./src/static/scripts/libs/recentlyViewed.js","webpack://recipes-nodejs/./src/static/scripts/libs/searchBox.js","webpack://recipes-nodejs/./src/static/scripts/libs/viewPicker.js","webpack://recipes-nodejs/./src/static/scripts/index.js"],"sourcesContent":["const StorageKeys = {\n  APP_NAME: 'RecipeNodeJs',\n};\n\nexport const KeyNames = Object.freeze({\n  /** most recently viewed recipe list */\n  RECENT: 'recent',\n  /** last search term */\n  SEARCH: 'search',\n  /** most recent search term list */\n  SEARCH_HISTORY: 'searchHistory',\n  /** most recently selected view/layout */\n  VIEW: 'content',\n});\n\nconst setAppData = (payload) => localStorage.setItem(StorageKeys.APP_NAME, JSON.stringify(payload));\n\nexport function getAppData() {\n  let payload = localStorage.getItem(StorageKeys.APP_NAME);\n  payload = payload && JSON.parse(payload);\n\n  if (!payload) {\n    payload = {\n\n    };\n    setAppData(payload);\n  }\n\n  return payload;\n}\n\nexport const updateKey = (key, value) => {\n  const payload = getAppData();\n  payload[key] = value;\n  setAppData(payload);\n};\n\nexport const getKey = (key, defaultValue) => {\n  const payload = getAppData();\n  const value = payload[key];\n  return value === undefined ? defaultValue : value;\n};\n\n/**\n * Add `value` in first position of list named `key`. When list length\n * exceeds `maxLength` last item is discarded.\n */\nexport const updateMRUList = (key, maxLength, value) => {\n  let list = getKey(key, []);\n  const index = list.indexOf(value);\n  if (index === 0) {\n    return;\n  }\n\n  if (index > -1) {\n    list.splice(index, 1);\n  }\n\n  list.unshift(value);\n\n  if (list.length > maxLength) {\n    list = list.slice(0, maxLength);\n  }\n\n  updateKey(key, list);\n};\n","import { KeyNames, getKey, updateMRUList } from './preferences.js';\n\nconst MAX_LIST_LENGTH = 50;\n\n/* eslint-disable key-spacing */\nconst Selectors = {\n  RECIPE_LIST:           '#recipe-list',\n\n  RECENTLY_VIEWED_BTN:   '#show-recents-btn',\n\n  MODAL:                 '#show-recents-modal',\n  MODAL_CONTENT:         '#show-recents-content',\n  MODAL_CLOST_BTN:       '#show-recents-close-btn',\n};\n/* eslint-enable key-spacing */\n\nconst Styles = {\n  MODAL_ACTIVE: 'modal--is-active',\n};\n\nexport const toDisplay = (value) => value\n  .replace(/-/g, ' ')\n  .replace(/\\w\\S*/g, (txt) => txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase())\n  .replace(/\\s+/g, ' ')\n  .trim();\n\nfunction onRecipeLinkClick(e) {\n  const anchor = e.target.tagName === 'A'\n    ? e.target\n    : e.target.closest('a');\n\n  if (anchor) {\n    const value = anchor.getAttribute('href');\n    if (value) {\n      updateMRUList(KeyNames.RECENT, MAX_LIST_LENGTH, value.replace(/^.*\\/|\\.html$/g, ''));\n    }\n  }\n}\n\nfunction toggleModal(isActive) {\n  const modal = document.querySelector(Selectors.MODAL);\n  modal.classList.toggle(Styles.MODAL_ACTIVE, isActive);\n  modal.setAttribute('aria-hidden', !isActive);\n}\n\nfunction onViewBtnClick() {\n  toggleModal(true);\n  document.querySelector(Selectors.MODAL_CONTENT).innerHTML = getKey(KeyNames.RECENT)\n    .map((value) => `<li><a href=\"${value}.html\">${toDisplay(value)}</a></li>`)\n    .join('');\n}\n\nexport function init() {\n  document.querySelector(Selectors.RECENTLY_VIEWED_BTN).addEventListener('click', onViewBtnClick);\n  // event delegation: record all recipe link clicks\n  document.querySelector(Selectors.RECIPE_LIST).addEventListener('click', onRecipeLinkClick);\n  document.querySelector(Selectors.MODAL_CLOST_BTN).addEventListener('click', () => toggleModal(false));\n}\n","import { KeyNames, updateKey } from './preferences.js';\n\n/* eslint-disable key-spacing */\nconst Styles = {\n  HIDDEN: 'recipe-list__item--hidden',\n};\n\nconst Selectors = {\n  RECIPE_LIST:  '#recipe-list',\n  RECIPE_ITEMS: '#recipe-list li',\n  SEARCH:       '#filter-field',\n  CLEAR_BTN:    '#clear-filter-btn',\n};\n\nconst KeyCodes = {\n  ESCAPE: 27,\n};\n/* eslint-enable key-spacing */\n\nexport const scrub = (value) => value\n  .trim()\n  .toLowerCase()\n  .replace(/\\W/g, '')\n  .replace(/\\s+/g, ' ');\n\nfunction filter(filterText) {\n  const words = filterText.split(/\\s+/).map((w) => scrub(w)).filter(Boolean);\n\n  document.querySelectorAll(Selectors.RECIPE_ITEMS)\n    .forEach((item) => {\n      if (!filterText) {\n        item.classList.remove(Styles.HIDDEN);\n      }\n      const { searchText } = item.dataset || '';\n      const isMatch = words.reduce((acc, word) => acc && searchText.includes(word), true);\n      item.classList.toggle(Styles.HIDDEN, !isMatch);\n    });\n}\n\nconst clearInput = () => {\n  const input = document.querySelector(Selectors.SEARCH);\n  input.value = '';\n  input.focus();\n  filter('');\n  updateKey(KeyNames.SEARCH, '');\n};\n\nexport function init(initalValue) {\n  // must build the index, and want to do that while everything is visible (using `innerText`)\n  const list = document.querySelector(Selectors.RECIPE_LIST);\n  list.style.opacity = '0';\n  // eslint-disable-next-line no-return-assign\n  document.querySelectorAll(Selectors.RECIPE_ITEMS).forEach((item) => item.dataset.searchText = scrub(item.innerText));\n\n  const input = document.querySelector(Selectors.SEARCH);\n  input.value = initalValue || '';\n  filter(initalValue);\n  list.style.opacity = '100%';\n\n  input.addEventListener('keyup', function onKeyUp() {\n    updateKey(KeyNames.SEARCH, this.value);\n    filter(this.value);\n  });\n\n  input.addEventListener('keydown', (e) => e.which === KeyCodes.ESCAPE && clearInput());\n\n  document.querySelector(Selectors.CLEAR_BTN).addEventListener('click', clearInput);\n}\n","import { KeyNames, updateKey } from './preferences.js';\n\nconst ViewTypes = Object.freeze([\n  'content',\n  'compact-list',\n  'grid',\n]);\n\nconst Selectors = {\n  RADIO_BTN: '.js-view-radio-btn',\n};\n\nfunction setView(view) {\n  ViewTypes.forEach((name) => document.body.classList.remove(`view--${name}`));\n  document.body.classList.add(`view--${view}`);\n}\n\nfunction onClick() {\n  const { view } = this.dataset;\n  updateKey(KeyNames.VIEW, view);\n  setView(view);\n}\n\nexport function init(initialIndexView) {\n  document.querySelectorAll(Selectors.RADIO_BTN)\n    .forEach((item) => item.addEventListener('click', onClick));\n  setView(initialIndexView);\n}\n","import { init as initRecentlyViewed } from './libs/recentlyViewed.js';\nimport { init as initSearchBox } from './libs/searchBox.js';\nimport { init as initViewBtns } from './libs/viewPicker.js';\nimport { KeyNames, getKey } from './libs/preferences.js';\n\nfunction run() {\n  const view = getKey(KeyNames.VIEW, 'content');\n  const search = getKey(KeyNames.SEARCH, '');\n\n  initSearchBox(search);\n  initViewBtns(view);\n  initRecentlyViewed();\n}\n\nrun();\n"],"names":["StorageKeys","KeyNames","Object","freeze","RECENT","SEARCH","SEARCH_HISTORY","VIEW","setAppData","payload","localStorage","setItem","JSON","stringify","getAppData","getItem","parse","updateKey","key","value","getKey","defaultValue","undefined","Selectors","RECIPE_LIST","RECENTLY_VIEWED_BTN","MODAL","MODAL_CONTENT","MODAL_CLOST_BTN","Styles","MODAL_ACTIVE","onRecipeLinkClick","e","anchor","target","tagName","closest","getAttribute","maxLength","list","index","indexOf","splice","unshift","length","slice","updateMRUList","replace","toggleModal","isActive","modal","document","querySelector","classList","toggle","setAttribute","onViewBtnClick","innerHTML","map","txt","charAt","toUpperCase","substr","toLowerCase","trim","toDisplay","join","KeyCodes","scrub","filter","filterText","words","split","w","Boolean","querySelectorAll","forEach","item","remove","searchText","dataset","isMatch","reduce","acc","word","includes","clearInput","input","focus","ViewTypes","setView","view","name","body","add","onClick","this","initialIndexView","initalValue","style","opacity","innerText","addEventListener","which","run"],"sourceRoot":""}